"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PaletteCache = void 0;
const Deleter_1 = require("../../Core/Deleter");
const BaseCache_1 = require("./BaseCache");
/**
 * @ignore
 */
class PaletteCache extends BaseCache_1.BaseCache {
    get value() {
        if (!this.cachedEntity && this.fillColors) {
            this.cachedEntity = this.create(this.fillColors);
        }
        return this.cachedEntity;
    }
    /**
     * Creates or fetches a new palette with the specified colors
     * @param fillColors
     */
    create(fillColors) {
        if (this.cachedEntity && fillColors === this.fillColors) {
            return this.cachedEntity;
        }
        Deleter_1.deleteSafe(this.cachedEntity);
        this.fillColors = fillColors;
        // @ts-ignore
        return this.cachedEntity = new this.webAssemblyContext.SCRTCreatePalette(fillColors);
    }
    reset() {
        this.invalidateCache();
        this.fillColors = undefined;
    }
}
exports.PaletteCache = PaletteCache;
